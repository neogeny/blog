<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!--
Design by Free CSS Templates
http://www.freecsstemplates.org
Released for free under a Creative Commons Attribution 2.5 License

Name       : Brown Stone
Description: A two-column, fixed-width design with dark color scheme.
Version    : 1.0
Released   : 20100928

-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="keywords" content="" />
<meta name="description" content="" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>Setting up a CVS repository on Linux</title>
<link href="/theme/css/style.css" rel="stylesheet" type="text/css" media="screen" />
<link href="/" type="application/atom+xml" rel="alternate" title="Neogeny ATOM Feed" />
</head>
<body>
<div id="wrapper">
	<div id="page">
		<div id="page-bgtop">
			<div id="page-bgbtm">
                        	<div id="content">
					<div class="post">
						<h2 class="title"><a href="setting-up-a-cvs-repository-on-linux.html">Setting up a CVS repository on Linux</a></h2>
						<p class="meta"><span class="date">Tue 05 September 2006 </span><span class="posted"><a href="#">Apalala</a></span><span>&nbsp; | : <a href="/category/penguins.html">penguins</a></span></p>
					<p class="meta">Tags : </p>
						<div style="clear: both;">&nbsp;</div>
						<div class="entry">
						 <!-- :tags: -->
<!-- :category: -->
<!-- :summary: -->
<div class="line-block">
<div class="line"><br /></div>
</div>
<blockquote>
It takes more than you'd think to bootstrap a team</blockquote>
<p>One might think that it is enough to create a directory under
<strong>/var/lib/cvs</strong> to get a new CVS repository working for a project. My
experience is that it takes much more to set up a CVS repository that
can be securely and seamlessly shared among members of a project group.</p>
<p>What follows is based on Fedora (RedHat) distributions of Linux, but it
will work with any other distribution with very few changes.</p>
<div class="section" id="work-as-root">
<h2>Work as <strong>root</strong></h2>
<p>Most of the commands that need to be executed for this setup are
privileged, so it is much easier to work as root. So do:</p>
<pre class="literal-block">
$ su
</pre>
<p>or try:</p>
<pre class="literal-block">
$ sudo su
</pre>
<p>If the first doesn't work (it doesn't on most Debian-based systems).</p>
</div>
<div class="section" id="install-cvs">
<h2>Install CVS</h2>
<p>Update to the latest version of CVS:</p>
<pre class="literal-block">
$ up2date cvs
</pre>
</div>
<div class="section" id="create-a-user-for-your-project">
<h2>Create a user for your project</h2>
<p>There are many way to set up directories for CVS. Many just create
directories (modules in CVS parlance) under <strong>/var/lib/cvs</strong>. In my
experience it is best to create a user/group pair for each project with
the corresponding directory under <strong>/home</strong>. That makes permission
management much easier and provides an obvious place to store
project-related files, create <em>cron</em> tasks, etc.</p>
<pre class="literal-block">
$ adduser myproject
</pre>
</div>
<div class="section" id="create-a-directory-for-the-cvs-repository">
<h2>Create a directory for the CVS repository</h2>
<p>This needs little explanation:</p>
<pre class="literal-block">
$ mkdir /home/myproject/cvs
</pre>
</div>
<div class="section" id="set-directory-permissions">
<h2>Set directory permissions</h2>
<p>The basic permissions must give read, write, and navigation abilities to
members of the project group, and to no one else.</p>
<pre class="literal-block">
$ chmod ug+rwX /home/myproject$ chmod ug+rwx /home/myproject/cvs$ chmod o-rwx --recursive /home/myproject
</pre>
</div>
<div class="section" id="set-the-sguid-bit-on-the-cvs-repository-directory">
<h2>Set the SGUID bit on the CVS repository directory</h2>
<p>It's a little known fact that setting the SGID (Set Group Id) bit on a
directory makes files and directories created under it inherit the
permissions of the parent. Setting the bit for a CVS repository is
indispensable because otherwise users will be able to create archive
files which only they can change.</p>
<pre class="literal-block">
$ chmod g+s /home/myproject/cvs
</pre>
<p>More information on the SGID bit over directories can be found
<a class="reference external" href="http://www.library.yale.edu/~lso/workstation/docs/permissions/sgid.htm">here</a>.</p>
</div>
<div class="section" id="initialize-the-cvs-repository">
<h2>Initialize the CVS repository</h2>
<p>$ cvs -d /home/myproject/cvs init</p>
<p>If you execute:</p>
<p>$ ls -l /home/myproject/cvs</p>
<p>You should see this:</p>
<pre class="literal-block">
drwxrws--- 3 myproject myproject 4096 2006-09-05 11:26 CVSROOT
</pre>
</div>
<div class="section" id="create-the-root-cvs-module">
<h2>Create the root CVS module</h2>
<p>CVS has this somewhat confusing concept of <em>modules</em>. To make a
potentially long explanation short, it is best if you create a directory
under the CVS repository to serve as root for all project files under
version control.</p>
<pre class="literal-block">
$ mkdir /home/myproject/cvs/myproject
</pre>
</div>
<div class="section" id="add-the-users-to-the-project-s-group">
<h2>Add the users to the project's group</h2>
<p>If you haven't created the users on the system, create them now:</p>
<pre class="literal-block">
$ adduser john$ adduser mary
</pre>
<p>Because we're going to use SSH (Secure Shell) access to the cvs
repository, it is important that each user has their own Linux login.
Otherwise CVS won't be able to capture who changed what.</p>
<p>Now add the users to the project's group:</p>
<pre class="literal-block">
$ usermod john -G myproject$ usermod mary -G myproject
</pre>
</div>
<div class="section" id="install-and-configure-ssh">
<h2>Install and configure SSH</h2>
<p>$ up2date ssh</p>
<p>You might want to tighten up security by restricting which users have
SSH access to the server, and you might have to tweak your firewall to
let traffic go through the SSH port (port 22).</p>
</div>
<div class="section" id="test">
<h2>Test</h2>
<p>You can try checking out the (for now empty) root module from CVS using
a remote desktop or server. The first step is to tell CVS that you want
to use SSH for remote repository access (something you might to set up
permanently in your <strong>~/.bashrc</strong> file or the likes):</p>
<pre class="literal-block">
$ export CVS_RSH=ssh
</pre>
<p>Next we extract the repository root:</p>
<pre class="literal-block">
$ cd ~ # switch to our home directory$ cvs -d :ext:myserver.com:/home/myproject/cvs co myproject
</pre>
<p>If you execute:</p>
<pre class="literal-block">
$ ls -l myproject
</pre>
<p>You should see something like:</p>
<pre class="literal-block">
drwxr-x--- 2 myname myname 4096 2006-09-05 11:39 CVS
</pre>
<p>If that works, you're almost a 100% set. &quot;Almost&quot;, because on some
systems you might need to set each project group member's UMASK to 007
in their <strong>~/.bashrc</strong> to avoid creation of archive files in the CVS
repository which are not group writable.</p>
<p><strong>That's it!</strong></p>
<p>As you many have noted, most of the steps in this process can be easily
automated using a shell script that is invoked as:</p>
<pre class="literal-block">
$ addproject myproject
</pre>
<p>That is exactly what I've done for gigs in which projects are created
frequently. In this case, writing the script is left as homework =)</p>
</div>

						</div>
					</div>

					<div style="clear: both;">&nbsp;</div>
				</div>
				<!-- end #content -->
				<div id="sidebar">
					<div id="logo">
						<h1><a href="">Neogeny</h1>
					</div>
					<div id="menu">
						<ul>
							<li class="current_page_item"><a href="">Home</a></li>
							<li><a href="/archives.html">Archives</a></li>
						</ul>
					</div>
					<ul>
						<li>
							<h2>Categories</h2>
							<ul>
								 <li ><a href="/category/aisthetikos.html">aisthetikos</a></li>
								 <li ><a href="/category/caudex.html">caudex</a></li>
								 <li ><a href="/category/dolcevita.html">dolcevita</a></li>
								 <li ><a href="/category/drafts.html">drafts</a></li>
								 <li ><a href="/category/ehoy.html">ehoy</a></li>
								 <li ><a href="/category/ethikos.html">ethikos</a></li>
								 <li ><a href="/category/grako.html">grako</a></li>
								 <li ><a href="/category/inpublishing.html">inpublishing</a></li>
								 <li ><a href="/category/mens.html">mens</a></li>
								 <li ><a href="/category/misc.html">misc</a></li>
								 <li ><a href="/category/parole.html">parole</a></li>
								 <li class="active"><a href="/category/penguins.html">penguins</a></li>
								 <li ><a href="/category/politikos.html">politikos</a></li>
								 <li ><a href="/category/snakes.html">snakes</a></li>
							</ul>
						</li>
						<li>
							<h2>Blogroll</h2>
							<ul>
                                                            <li><a href="http://getpelican.com/">Pelican</a></li>
                                                            <li><a href="http://python.org/">Python.org</a></li>
                                                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                                                            <li><a href="#">You can modify those links in your config file</a></li>
							</ul>
						</li>
                                                <li>
                                                        <h2>Social</h2>
                                                        <ul>
                                                            <li><a href="/" rel="alternate">Flux Atom</a></li>
                                                            <li><a href="#">You can add links in your config file</a></li>
                                                            <li><a href="#">Another social link</a></li>
                                                        </ul>
                                                </li><!-- /.social -->
						<li>
						        <h2>Tags</h2>
						        <ul>
						        </ul>
						</li>


					</ul>
				</div>
				<!-- end #sidebar -->
				<div style="clear: both;">&nbsp;</div>
			</div>
		</div>
	</div>
	<!-- end #page -->

<div id="footer">
	<p>Copyright (c) 2008 Sitename.com. All rights reserved. Design by <a href="http://www.freecsstemplates.org/">CSS Templates</a>.</p>
	<p>Proudly powered by <a href="http://alexis.notmyidea.org/pelican/">pelican</a>, which takes great advantages of <a href="http://python.org">python</a>.
</p>
</div>
<!-- end #footer -->
</body>
</html>